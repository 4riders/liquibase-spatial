<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
   xmlns:spatial="http://www.liquibase.org/xml/ns/dbchangelog-ext/liquibase-spatial"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd 
         http://www.liquibase.org/xml/ns/dbchangelog-ext/liquibase-spatial src/main/resources/liquibase/ext/spatial/xml/liquibase-spatial.xsd">
   <changeSet id="Spatialize DB" author="test">
      <sql dbms="h2">CREATE ALIAS InitGeoDB for "geodb.GeoDB.InitGeoDB"</sql>
      <sql dbms="h2">CALL InitGeoDB()</sql>
   </changeSet>

   <changeSet id="Create table" author="test">
      <preConditions>
         <spatial:spatialSupported />
      </preConditions>
      <createTable tableName="TEST">
         <column name="ID" type="BIGINT">
            <constraints nullable="false" primaryKey="true" />
         </column>
         <column name="GEOM" type="GEOMETRY">
            <constraints nullable="false" />
         </column>
      </createTable>
   </changeSet>

   <changeSet id="Create spatial index" author="test">
      <preConditions>
         <tableExists tableName="TEST" />
         <not>
            <spatial:spatialIndexExists tableName="TEST" />
         </not>
      </preConditions>
      <spatial:createSpatialIndex tableName="TEST"
         indexName="TEST_GEOM_IDX">
         <column name="GEOM" />
      </spatial:createSpatialIndex>
   </changeSet>

   <changeSet id="Insert spatial data" author="test">
      <preConditions>
         <spatial:spatialIndexExists tableName="TEST" />
      </preConditions>
      <insert tableName="TEST">
         <column name="ID" value="1" />
         <column name="GEOM" value="SRID=4326;POINT(-5 -5)" />
      </insert>
      <insert tableName="TEST">
         <column name="ID" value="2" />
         <column name="GEOM" value="SRID=4326;POINT(0 0)" />
      </insert>
      <insert tableName="TEST">
         <column name="ID" value="3" />
         <column name="GEOM" value="SRID=4326;POINT(5 5)" />
      </insert>
   </changeSet>
</databaseChangeLog>
